<!-- form_gera_termo_solic_crp_2.html -->
<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Formulário – Solicitação de CRP Emergencial (Programa de Regularidade RPPS)</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet"/>
  <link href="https://fonts.cdnfonts.com/css/rawline" rel="stylesheet">
  <link rel="icon" href="imagens/favicon.svg" type="image/svg+xml" sizes="any">
  <link rel="icon" href="imagens/favicon.png" sizes="32x32" type="image/png">
  <link rel="icon" href="imagens/favicon.png" sizes="16x16" type="image/png">
  <link rel="stylesheet" href="styles.css" />
  <style>
    body{font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;}
    .title-black{color:#0b0d12}
    .app-stepper{display:flex;align-items:center;justify-content:center;gap:.5rem}
    .app-stepper .step{width:32px;height:32px;border-radius:50%;display:flex;align-items:center;justify-content:center;background:#e9ecef}
    .app-stepper .step.active{background:#0d6efd;color:#fff}
    .app-card.glass{backdrop-filter:saturate(1.1) blur(4px);border:1px solid rgba(0,0,0,.06)}
    .section-head .section-title{font-weight:800;font-size:1.1rem}
    .sub-title{font-weight:600}
    .help-text{font-size:.85rem}
  </style>
</head>
<body>
  <div class="container-xl py-4 position-relative">
    <header class="mb-4 text-center">
      <div class="brand mb-2">
        <img src="imagens/logo-termo-drpps.svg" alt="MPS" height="56">
      </div>
      <h1 class="h3 fw-800 mb-2 title-black">
        FORMULÁRIO PARA GERAÇÃO DO TERMO DE <br>SOLICITAÇÃO DE CRP EMERGENCIAL PRÓ-REGULARIDADE RPPS
      </h1>
    </header>
    <div id="stepper" class="app-stepper mb-3">
      <div class="step active">1</div><div class="divider"></div>
      <div class="step">2</div><div class="divider"></div>
      <div class="step">3</div><div class="divider"></div>
      <div class="step">4</div><div class="divider"></div>
      <div class="step">5</div><div class="divider"></div>
      <div class="step">6</div>
    </div>
    <div class="card app-card glass">
      <div class="card-body">
        <form id="solicCrpForm" novalidate autocomplete="off">
          <!-- ETAPA 0: Pesquisa + gate Gescon -->
          <section class="app-section" data-step="0">
            <input type="hidden" id="HAS_TERMO_ENC_GESCON" value="0" />
            <div class="section-head">
              <h2 class="section-title">Pesquisa inicial</h2>
            </div>
            <div class="row g-2 align-items-end" id="pesquisaRow">
              <div class="col-12 col-md-6 col-lg-5">
                <label for="CNPJ_ENTE_PESQ" class="form-label">CNPJ do Ente</label>
                <input type="text" class="form-control" id="CNPJ_ENTE_PESQ" placeholder="00.000.000/0000-00" />
              </div>
              <div class="col-auto">
                <label class="d-none d-md-block">&nbsp;</label>
                <button type="button" id="btnPesquisar" class="btn btn-primary px-4">Pesquisar</button>
              </div>
              <div class="col-auto ms-auto" id="slotNextStep0">
                <label class="d-none d-md-block">&nbsp;</label>
              </div>
            </div>

            <div class="alert alert-info mt-3 d-none" id="gesconInfoBox">
              <div class="small">Registro do Termo de Adesão ao Pró-Regularidade RPPS:</div>
              <ul class="mb-0 small">
                <li><strong>Enviado via Consulta GESCON:</strong> <span id="N_GESCON">—</span> <span id="infoNumGescon" class="d-none">—</span></li>
                <li><strong>Data do encaminhamento:</strong> <span id="DATA_ENC_VIA_GESCON">—</span></li>
                <li><strong>UF:</strong> <span id="UF_GESCON">—</span></li>
                <li><strong>Ente:</strong> <span id="ENTE_GESCON">—</span></li>
                <li><strong>Nº Processo SEI:</strong> <span id="INFO_PROC_SEI">—</span></li>
              </ul>
            </div>
            <div class="d-none">
              <span id="INTRO_N_GESCON">—</span>
              <span id="INTRO_DATA_ENC">—</span>
              <span id="INTRO_PROC_SEI">—</span>
              <span id="intro_N_GESCON">—</span>
              <span id="intro_DATA_ENC">—</span>
            </div>
          </section>

          <!-- ETAPA 1 -->
          <section class="app-section" data-step="1">
            <div id="intro_item1_extra" class="mt-2">
              <p class="small mb-2">
                O RPPS abaixo especificado requer a emissão de CRP em caráter emergencial, no âmbito do Programa de Regularidade Previdenciária dos RPPS.
              </p>
              <p class="small mb-2"><strong>Registros do Termo de Adesão</strong>:</p>
              <ul class="small">
                <li>Enviado via consulta Gescon: <span id="reg-gescon-consulta">—</span></li>
                <li>Data do encaminhamento: <span id="reg-data-encam">—</span></li>
                <li>Processo SEI: <span id="reg-proc-sei">—</span></li>
              </ul>
            </div>
            <div class="section-head">
              <h2 class="section-title">1. Identificação do ente federativo</h2>
              <p class="small text-muted mb-0">Informe a esfera de Governo, o ente e a UG do RPPS.</p>
            </div>

            <div class="mb-3" id="grpESFERA">
              <div class="sub-title mb-2">1.1 Esfera de Governo</div>
              <div class="d-flex flex-wrap gap-4">
                <div class="form-check">
                  <input class="form-check-input esf-only-one" type="checkbox" id="esf_mun" name="ESFERA_GOVERNO[]" value="RPPS Municipal">
                  <label class="form-check-label" for="esf_mun">RPPS Municipal</label>
                </div>
                <div class="form-check">
                  <input class="form-check-input esf-only-one" type="checkbox" id="esf_est" name="ESFERA_GOVERNO[]" value="Estadual/Distrital">
                  <label class="form-check-label" for="esf_est">Estadual/Distrital</label>
                </div>
              </div>
            </div>

            <div class="row g-3">
              <div class="col-12"><div class="sub-title">1.2 Ente Federativo</div></div>
              <div class="col-md-2">
                <label class="form-label" for="UF">UF</label>
                <select id="UF" class="form-select">
                  <option value="">Selecione…</option>
                  <option>AC</option><option>AL</option><option>AM</option><option>AP</option>
                  <option>BA</option><option>CE</option><option>DF</option><option>ES</option>
                  <option>GO</option><option>MA</option><option>MG</option><option>MS</option>
                  <option>MT</option><option>PA</option><option>PB</option><option>PE</option>
                  <option>PI</option><option>PR</option><option>RJ</option><option>RN</option>
                  <option>RO</option><option>RR</option><option>RS</option><option>SC</option>
                  <option>SE</option><option>SP</option><option>TO</option>
                </select>
              </div>
              <div class="col-md-4">
                <label class="form-label" for="ENTE">Ente</label>
                <input type="text" id="ENTE" class="form-control" />
              </div>
              <div class="col-md-3">
                <label class="form-label" for="CNPJ_ENTE">CNPJ</label>
                <input type="text" id="CNPJ_ENTE" class="form-control" placeholder="00.000.000/0000-00" />
              </div>
              <div class="col-md-3">
                <label class="form-label" for="EMAIL_ENTE">E-mail</label>
                <input type="email" id="EMAIL_ENTE" class="form-control" placeholder="ente@exemplo.gov.br" />
              </div>

              <div class="col-12 mt-2"><div class="sub-title">1.3 Regime Próprio de Previdência Social (RPPS)</div></div>
              <div class="col-md-6">
                <label class="form-label" for="UG">Unidade Gestora</label>
                <input type="text" id="UG" class="form-control" />
              </div>
              <div class="col-md-3">
                <label class="form-label" for="CNPJ_UG">CNPJ</label>
                <input type="text" id="CNPJ_UG" class="form-control" placeholder="00.000.000/0000-00" />
              </div>
              <div class="col-md-3">
                <label class="form-label" for="EMAIL_UG">E-mail</label>
                <input type="email" id="EMAIL_UG" class="form-control" placeholder="ug@exemplo.gov.br" />
              </div>

              <div class="col-12 mt-2"><div class="sub-title">1.3 Regime</div></div>
              <div class="col-12">
                <label class="form-label mb-1 d-block">Situação do RPPS</label>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" name="rpps_situacao" id="rpps_situacao_ativo" value="RPPS" checked>
                  <label class="form-check-label" for="rpps_situacao_ativo">RPPS</label>
                </div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" name="rpps_situacao" id="rpps_situacao_extincao" value="RPPS em Extinção">
                  <label class="form-check-label" for="rpps_situacao_extincao">RPPS em Extinção</label>
                </div>
              </div>

              <div class="col-12 mt-2" id="grpUG" data-ug-obrigatoria="true">
                <div class="sub-title small mb-2">1.3.2 Unidade Gestora (UG)</div>
                <div class="row g-3">
                  <div class="col-md-6">
                    <label class="form-label" for="ug_nome">Nome da UG</label>
                    <input type="text" class="form-control" id="ug_nome" name="ug_nome" required aria-required="true" placeholder="Ex.: Instituto de Previdência do Município">
                  </div>
                  <div class="col-md-3">
                    <label class="form-label" for="ug_cnpj">CNPJ</label>
                    <input type="text" class="form-control" id="ug_cnpj" name="ug_cnpj" required aria-required="true" placeholder="00.000.000/0000-00">
                  </div>
                  <div class="col-md-3">
                    <label class="form-label" for="ug_email">E-mail</label>
                    <input type="email" class="form-control" id="ug_email" name="ug_email" required aria-required="true" placeholder="ug@exemplo.gov.br">
                  </div>
                  <div class="col-md-6">
                    <label class="form-label" for="ug_orgao_vinc">Órgão de Vinculação</label>
                    <input type="text" class="form-control" id="ug_orgao_vinc" name="ug_orgao_vinc" required aria-required="true" placeholder="Ex.: Secretaria de Administração">
                  </div>
                </div>
                <small id="ugHint" class="help-text small text-muted d-none">Com “RPPS em Extinção”, os dados da UG não são obrigatórios.</small>
              </div>
            </div>
          </section>
          <!-- ETAPA 2 -->
          <section class="app-section" data-step="2">
            <div class="section-head">
              <h2 class="section-title">2. Identificação dos responsáveis</h2>
              <p class="small text-muted mb-0">Digite o CPF e clique em “Pesquisar” em cada subitem.</p>
            </div>

            <div class="card-subblock mb-3">
              <div class="sub-title">2.1 Representante legal do ente federativo</div>
              <div class="row g-3 align-items-end">
                <div class="col-12 col-md-6">
                  <label class="form-label" for="CPF_REP_ENTE">CPF</label>
                  <input type="text" id="CPF_REP_ENTE" class="form-control" placeholder="000.000.000-00" />
                </div>
                <div class="col-auto">
                  <label class="d-none d-md-block">&nbsp;</label>
                  <button type="button" id="btnPesqRepEnte" class="btn btn-outline-primary">Pesquisar</button>
                </div>
                <div class="col-12">
                  <label class="form-label" for="NOME_REP_ENTE">Nome</label>
                  <input id="NOME_REP_ENTE" class="form-control" />
                </div>
                <div class="col-12">
                  <label class="form-label" for="CARGO_REP_ENTE">Cargo/Função</label>
                  <input id="CARGO_REP_ENTE" class="form-control" />
                </div>
                <div class="col-12">
                  <label class="form-label" for="EMAIL_REP_ENTE">E-mail</label>
                  <input type="email" id="EMAIL_REP_ENTE" class="form-control" />
                </div>
                <div class="col-12">
                  <label class="form-label" for="TEL_REP_ENTE">Telefone</label>
                  <input type="text" id="TEL_REP_ENTE" class="form-control" placeholder="(00) 00000-0000" />
                </div>
              </div>
            </div>

            <div class="card-subblock">
              <div class="sub-title">2.2 Representante legal do RPPS</div>
              <div class="row g-3 align-items-end">
                <div class="col-12 col-md-6">
                  <label class="form-label" for="CPF_REP_UG">CPF</label>
                  <input type="text" id="CPF_REP_UG" class="form-control" placeholder="000.000.000-00" />
                </div>
                <div class="col-auto">
                  <label class="d-none d-md-block">&nbsp;</label>
                  <button type="button" id="btnPesqRepUg" class="btn btn-outline-primary">Pesquisar</button>
                </div>
                <div class="col-12">
                  <label class="form-label" for="NOME_REP_UG">Nome</label>
                  <input id="NOME_REP_UG" class="form-control" />
                </div>
                <div class="col-12">
                  <label class="form-label" for="CARGO_REP_UG">Cargo/Função</label>
                  <input id="CARGO_REP_UG" class="form-control" />
                </div>
                <div class="col-12">
                  <label class="form-label" for="EMAIL_REP_UG">E-mail</label>
                  <input type="email" id="EMAIL_REP_UG" class="form-control" />
                </div>
                <div class="col-12">
                  <label class="form-label" for="TEL_REP_UG">Telefone</label>
                  <input type="text" id="TEL_REP_UG" class="form-control" placeholder="(00) 00000-0000" />
                </div>
              </div>
            </div>
          </section>
          <!-- ETAPA 3 -->
          <section id="secCRP" class="app-section" data-step="3">
            <h2 class="section-title">3. Situação relativa ao CRP</h2>

            <!-- 3.1 Data de vencimento do último CRP -->
            <div class="mb-3">
              <div class="sub-title">3.1 Data de vencimento do último CRP</div>
              <div class="row g-2 align-items-center">
                <div class="col-12 col-md-4">
                  <label class="form-label" for="DATA_VENC_ULTIMO_CRP">Data</label>
                  <input type="date" class="form-control" id="DATA_VENC_ULTIMO_CRP" name="DATA_VENC_ULTIMO_CRP" placeholder="dd/mm/aaaa" />
                  <div class="form-text">Se preferir, digite no formato dd/mm/aaaa.</div>
                </div>
              </div>
            </div>
            <hr class="my-3">

            <!-- 3.2 Tipo de emissão do último CRP -->
            <div class="mb-3">
              <div class="sub-title">3.2 Tipo de emissão do último CRP</div>
              <div class="row g-2">
                <div class="col-12 col-md-6">
                  <label class="form-label" for="TIPO_EMISSAO_ULTIMO_CRP">Tipo</label>
                  <select id="TIPO_EMISSAO_ULTIMO_CRP" name="TIPO_EMISSAO_ULTIMO_CRP" class="form-select">
                    <option value="">Selecione…</option>
                    <option value="Administrativa">Administrativa</option>
                    <option value="Judicial">Judicial</option>
                  </select>
                </div>
              </div>
            </div>
            <hr class="my-3">

            <!-- 3.3 Critérios irregulares -->
            <div class="mb-3">
              <div class="sub-title">3.3 Critério(s) atualmente irregular(es) no extrato previdenciário</div>
              <p class="small text-muted mb-2">Selecione todos os itens apontados como irregulares no extrato.</p>

              <div class="d-flex flex-column gap-2" id="grpCRITERIOS">
                <!-- (amostra de 10; complete sua lista conforme necessidade) -->
                <label class="form-check">
                  <input class="form-check-input me-2" type="checkbox" name="CRITERIOS_IRREGULARES[]" value="1-Atendimento à solicitação de legislação, documentos ou informações pela Secretaria de Regime Próprio e Complementar">
                  <span class="form-check-label">1 - Atendimento à solicitação de legislação, documentos ou informações pela Secretaria de Regime Próprio e Complementar</span>
                </label>
                <label class="form-check">
                  <input class="form-check-input me-2" type="checkbox" name="CRITERIOS_IRREGULARES[]" value="2-Aplicações Financeiras Resol. CMN - Adequação DAIR e Política Investimentos (objeto de PAP)">
                  <span class="form-check-label">2 - Aplicações Financeiras Resol. CMN - Adequação DAIR e Política Investimentos (objeto de PAP)</span>
                </label>
                <label class="form-check">
                  <input class="form-check-input me-2" type="checkbox" name="CRITERIOS_IRREGULARES[]" value="8-Demonstrativo das Aplicações e Investimentos dos Recursos - DAIR – Encaminhamento">
                  <span class="form-check-label">8 - DAIR – Encaminhamento</span>
                </label>
                <label class="form-check">
                  <input class="form-check-input me-2" type="checkbox" name="CRITERIOS_IRREGULARES[]" value="10-Demonstrativo de Informações Previdenciárias e Repasses - DIPR – Encaminhamento">
                  <span class="form-check-label">10 - DIPR – Encaminhamento</span>
                </label>
                <label class="form-check">
                  <input class="form-check-input me-2" type="checkbox" name="CRITERIOS_IRREGULARES[]" value="11-Envio da Matriz de Saldos Contábeis (MSC) por meio do Siconfi">
                  <span class="form-check-label">11 - Matriz de Saldos Contábeis (MSC)</span>
                </label>
                <label class="form-check">
                  <input class="form-check-input me-2" type="checkbox" name="CRITERIOS_IRREGULARES[]" value="21-Requisitos para dirigentes e membros dos conselhos e comitê de investimentos do RPPS">
                  <span class="form-check-label">21 - Requisitos para dirigentes/conselhos/comitê</span>
                </label>
              </div>
            </div>

            <!-- 3.4 Prazo adicional (rádio + texto livre opcional) -->
            <div class="mb-3">
              <div class="sub-title">3.4 Prazo adicional (quando aplicável)</div>
              <div class="d-flex flex-column gap-2">
                <label class="form-check"><input class="form-check-input me-2" type="radio" name="PRAZO_ADICIONAL_3_4" value="3.4.1"> <span>3.4.1 Manutenção da conformidade</span></label>
                <label class="form-check"><input class="form-check-input me-2" type="radio" name="PRAZO_ADICIONAL_3_4" value="3.4.2"> <span>3.4.2 Equacionamento do déficit atuarial</span></label>
                <label class="form-check"><input class="form-check-input me-2" type="radio" name="PRAZO_ADICIONAL_3_4" value="3.4.3"> <span>3.4.3 Organização do RPPS / critérios estruturantes</span></label>
                <label class="form-check"><input class="form-check-input me-2" type="radio" name="PRAZO_ADICIONAL_3_4" value="3.4.4"> <span>3.4.4 Outro critério de maior complexidade</span></label>
              </div>
              <div class="mt-2">
                <label class="form-label" for="przTexto">Descrição (opcional)</label>
                <textarea class="form-control" id="przTexto" rows="2" placeholder="Detalhe a necessidade do prazo adicional, se for o caso."></textarea>
              </div>
            </div>
          </section>
          <!-- ETAPA 4: Seleção de Fase (4.1 a 4.6) -->
          <section class="app-section" data-step="4">
            <div class="section-head">
              <h2 class="section-title">4. Fase do Programa</h2>
              <p class="small text-muted mb-2">Selecione uma fase (ao selecionar, o modal com opções abrirá).</p>
            </div>

            <div class="d-flex flex-column gap-2">
              <label class="form-check"><input class="form-check-input" type="radio" name="FASE_PROGRAMA" value="4.1"> <span>4.1 – Parcelamento de débitos (até 60 / até 300)</span></label>
              <label class="form-check"><input class="form-check-input" type="radio" name="FASE_PROGRAMA" value="4.2"> <span>4.2 – Regularização administrativa</span></label>
              <label class="form-check"><input class="form-check-input" type="radio" name="FASE_PROGRAMA" value="4.3"> <span>4.3 – Déficit atuarial (planos/medidas)</span></label>
              <label class="form-check"><input class="form-check-input" type="radio" name="FASE_PROGRAMA" value="4.4"> <span>4.4 – Critérios estruturantes</span></label>
              <label class="form-check"><input class="form-check-input" type="radio" name="FASE_PROGRAMA" value="4.5"> <span>4.5 – Compromissos/documentos/execução</span></label>
              <label class="form-check"><input class="form-check-input" type="radio" name="FASE_PROGRAMA" value="4.6"> <span>4.6 – Manutenção de conformidade / Pró-Gestão / ISP</span></label>
            </div>

            <!-- Blocos placeholders (usados pelo JS em validação e coleta) -->
            <div id="blk_41" class="d-none">
              <div class="form-check"><input class="form-check-input" type="radio" name="F41_OPCAO" value="4.1.1" id="opt411"><label class="form-check-label" for="opt411">4.1.1 – até 60 parcelas</label></div>
              <div class="form-check"><input class="form-check-input" type="radio" name="F41_OPCAO" value="4.1.2" id="opt412"><label class="form-check-label" for="opt412">4.1.2 – até 300 parcelas</label></div>
            </div>
            <div id="blk_42" class="d-none"><div id="F42_LISTA" class="d-flex flex-column gap-2"></div></div>
            <div id="blk_43" class="d-none">
              <div id="F43_LISTA" class="d-flex flex-column gap-2"></div>
              <div class="mt-2">
                <label class="form-label">Plano(s) / Medidas</label>
                <input id="F43_PLANO" class="form-control mb-2" placeholder="Ex.: Plano A"> 
                <input id="F43_PLANO_B" class="form-control mb-2" placeholder="Ex.: Plano B (opcional)">
                <textarea id="F43_DESC_PLANOS" class="form-control" rows="2" placeholder="Descrição resumida"></textarea>
              </div>
              <div class="mt-2">
                <div class="form-check form-switch">
                  <input class="form-check-input" type="checkbox" id="F43_SOLICITA_INCLUSAO">
                  <label class="form-check-label" for="F43_SOLICITA_INCLUSAO">Solicita inclusão de itens</label>
                </div>
                <div id="F43_INCLUSAO_WRAP" class="mt-2 d-none">
                  <div id="F43_INCLUIR" class="d-flex flex-column gap-1"></div>
                </div>
              </div>
              <div class="mt-3">
                <label class="form-label">4.3.10 – Selecione A ou B</label>
                <div class="d-flex gap-3">
                  <label class="form-check"><input class="form-check-input" type="radio" name="F4310_OPCAO" value="A"> <span>Apresentar legislação</span></label>
                  <label class="form-check"><input class="form-check-input" type="radio" name="F4310_OPCAO" value="B"> <span>Apresentar documentos</span></label>
                </div>
                <div id="F4310_LEGISLACAO_WRAP" class="mt-2 d-none">
                  <label class="form-label" for="F4310_LEGISLACAO">Legislação</label>
                  <textarea id="F4310_LEGISLACAO" class="form-control" rows="2"></textarea>
                </div>
                <div id="F4310_DOCS_WRAP" class="mt-2 d-none">
                  <label class="form-label" for="F4310_DOCS">Documentos</label>
                  <textarea id="F4310_DOCS" class="form-control" rows="2"></textarea>
                </div>
              </div>
            </div>

            <div id="blk_44" class="d-none">
              <div id="F44_FINALIDADES" class="d-flex flex-column gap-2 mb-2"></div>
              <div class="d-flex gap-3 align-items-center mb-2">
                <label class="form-check"><input class="form-check-input" type="checkbox" id="F441_OPTD" value="d"> <span>4.4.1(d) – Citar legislação</span></label>
                <div id="F441_LEGISLACAO_WRAP" class="flex-fill d-none"><input id="F441_LEGISLACAO" class="form-control" placeholder="Ex.: Lei nº ..." /></div>
              </div>
              <div class="d-flex gap-3 align-items-start mb-2">
                <label class="form-check mt-2"><input class="form-check-input" type="checkbox" id="F442_OPTE" value="e"> <span>4.4.2(e) – Abrir critérios</span></label>
                <div id="F44_CRIT_WRAP" class="flex-fill d-none">
                  <div id="F44_CRITERIOS" class="d-flex flex-column gap-2"></div>
                </div>
              </div>
              <div class="mb-2">
                <label class="form-label" for="F44_ANEXOS">Anexos (descrição)</label>
                <textarea id="F44_ANEXOS" class="form-control" rows="2"></textarea>
              </div>
              <div class="mb-2">
                <label class="form-label" for="F445_DESC_PLANOS">Descrição de planos (se houver)</label>
                <textarea id="F445_DESC_PLANOS" class="form-control" rows="2"></textarea>
              </div>
              <div class="mb-2">
                <label class="form-label" for="F446_DOCS">Documentos (lista)</label>
                <textarea id="F446_DOCS" class="form-control" rows="2"></textarea>
              </div>
              <div class="mb-2">
                <label class="form-label" for="F446_EXEC_RES">Execução/resultado esperado</label>
                <textarea id="F446_EXEC_RES" class="form-control" rows="2"></textarea>
              </div>
            </div>
            <div id="blk_45" class="d-none">
              <div class="form-check mb-2"><input class="form-check-input" type="checkbox" id="F45_451"><label class="form-check-label ms-2" for="F45_451">4.5.1 – Concordo com os compromissos firmados</label></div>
              <div class="mb-2">
                <label class="form-label" for="F45_DOCS">Documentos</label>
                <textarea id="F45_DOCS" class="form-control" rows="2"></textarea>
              </div>
              <div class="mb-2">
                <label class="form-label" for="F45_JUST">Justificativas</label>
                <textarea id="F45_JUST" class="form-control" rows="2"></textarea>
              </div>
              <div class="mb-2">
                <label class="form-label" for="F453_EXEC_RES">Execução/resultado esperado</label>
                <textarea id="F453_EXEC_RES" class="form-control" rows="2"></textarea>
              </div>
            </div>

            <div id="blk_46" class="d-none">
              <div class="mb-2">
                <div id="F46_CRITERIOS" class="d-flex flex-column gap-2"></div>
              </div>
              <div class="row g-2 mb-2">
                <div class="col-md-4">
                  <label class="form-label" for="F46_PROGESTAO">Nível Pró-Gestão</label>
                  <select id="F46_PROGESTAO" class="form-select">
                    <option value="">Selecione…</option>
                    <option>Bronze</option><option>Prata</option><option>Ouro</option><option>Diamante</option>
                  </select>
                </div>
                <div class="col-md-4">
                  <label class="form-label" for="F46_PORTE">Porte (ISP-RPPS)</label>
                  <select id="F46_PORTE" class="form-select">
                    <option value="">Selecione…</option>
                    <option>Pequeno</option><option>Médio</option><option>Grande</option>
                  </select>
                </div>
              </div>

              <div class="mb-2">
                <label class="form-label" for="F46_FINALIDADES">Finalidades</label>
                <div id="F46_FINALIDADES" class="d-flex flex-column gap-2"></div>
              </div>
              <div class="mb-2">
                <label class="form-label" for="F46_ANEXOS">Anexos (descrição)</label>
                <textarea id="F46_ANEXOS" class="form-control" rows="2"></textarea>
              </div>

              <div class="border rounded p-2 mt-2">
                <div class="form-check mb-2">
                  <input class="form-check-input" type="checkbox" id="F462F_OPTF" value="f">
                  <label class="form-check-label" for="F462F_OPTF">4.6.2 (f) – Abrir critérios adicionais</label>
                </div>
                <div id="F462F_WRAP" class="d-none">
                  <div id="F462F_CRITERIOS" class="d-flex flex-column gap-2"></div>
                </div>
              </div>

              <div class="row g-2 mt-2">
                <div class="col-md-6">
                  <label class="form-label" for="F46_JUST_PLANOS">Condição de vigência (se planos)</label>
                  <textarea id="F46_JUST_PLANOS" class="form-control" rows="2"></textarea>
                </div>
                <div class="col-md-6">
                  <label class="form-label" for="F46_COMP_CUMPR">Compromissos de cumprimento</label>
                  <textarea id="F46_COMP_CUMPR" class="form-control" rows="2"></textarea>
                </div>
              </div>
            </div>
          </section>

          <!-- ETAPA 5 -->
          <section class="app-section" data-step="5">
            <div class="section-head">
              <h2 class="section-title">5. Justificativas gerais</h2>
            </div>
            <textarea id="JUSTIFICATIVAS_GERAIS" class="form-control" rows="4" placeholder="Inclua justificativas e observações gerais, se necessário."></textarea>
          </section>
          <!-- RODAPÉ DE NAVEGAÇÃO -->
          <div id="navFooter" class="d-flex align-items-center gap-2 mt-3">
            <button type="button" id="btnPrev" class="btn btn-outline-secondary">Voltar</button>
            <button type="button" id="btnNext" class="btn btn-primary">Próximo</button>
            <div class="ms-auto d-flex gap-2">
              <button type="button" id="btnGerarFormulario" class="btn btn-outline-primary">Gerar PDF</button>
              <button type="submit" id="btnSubmit" class="btn btn-success d-none">Finalizar</button>
            </div>
          </div>

          <!-- CARIMBOS OCULTOS -->
          <input type="hidden" id="MES" />
          <input type="hidden" id="DATA_SOLIC_GERADA" />
          <input type="hidden" id="HORA_SOLIC_GERADA" />
          <input type="hidden" id="ANO_SOLIC_GERADA" />
        </form>
      </div>
    </div>
    <!-- MODAIS GERAIS -->
    <div class="modal fade" id="modalWelcome" tabindex="-1"><div class="modal-dialog"><div class="modal-content">
      <div class="modal-header"><h5 class="modal-title">Bem-vindo</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div>
      <div class="modal-body"><p class="mb-0">Preencha as etapas e selecione a fase (4.x) conforme sua necessidade.</p></div>
      <div class="modal-footer"><button class="btn btn-primary" data-bs-dismiss="modal">Ok</button></div>
    </div></div></div>

    <div class="modal fade" id="modalAtencao" tabindex="-1"><div class="modal-dialog"><div class="modal-content">
      <div class="modal-header"><h5 class="modal-title">Atenção</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div>
      <div class="modal-body"><ul id="modalAtencaoLista" class="mb-0"></ul><div id="lottieAtencao" style="height:120px"></div></div>
      <div class="modal-footer"><button class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button></div>
    </div></div></div>

    <div class="modal fade" id="modalErro" tabindex="-1"><div class="modal-dialog"><div class="modal-content">
      <div class="modal-header"><h5 class="modal-title">Erro</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div>
      <div class="modal-body"><ul id="modalErroLista" class="mb-0"></ul><div id="lottieError" style="height:120px"></div></div>
      <div class="modal-footer"><button class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button></div>
    </div></div></div>

    <div class="modal fade" id="modalGerandoPdf" tabindex="-1"><div class="modal-dialog modal-sm modal-dialog-centered"><div class="modal-content">
      <div class="modal-body text-center">
        <div id="lottieGerandoPdf" style="height:160px"></div>
        <div class="small">Gerando PDF…</div>
      </div>
    </div></div></div>

    <div class="modal fade" id="modalSalvando" tabindex="-1"><div class="modal-dialog modal-sm modal-dialog-centered"><div class="modal-content">
      <div class="modal-body text-center">
        <div id="lottieSalvando" style="height:160px"></div>
        <div class="small">Salvando…</div>
      </div>
    </div></div></div>

    <div class="modal fade" id="modalSucesso" tabindex="-1"><div class="modal-dialog"><div class="modal-content">
      <div class="modal-header"><h5 class="modal-title">Concluído</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div>
      <div class="modal-body text-center"><div id="lottieSuccess" style="height:140px"></div><p class="mb-0">Operação realizada com sucesso.</p></div>
      <div class="modal-footer"><button class="btn btn-primary" data-bs-dismiss="modal">Ok</button></div>
    </div></div></div>

    <div class="modal fade" id="modalGesconNaoEncontrado" tabindex="-1"><div class="modal-dialog"><div class="modal-content">
      <div class="modal-header"><h5 class="modal-title">Registro não localizado</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div>
      <div class="modal-body">
        <p>Não localizamos o encaminhamento via GESCON. Por favor, verifique se o Termo de Adesão foi enviado e tente novamente.</p>
      </div>
      <div class="modal-footer"><button class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button></div>
    </div></div></div>

    <div class="modal fade" id="modalBusca" tabindex="-1"><div class="modal-dialog"><div class="modal-content">
      <div class="modal-header"><h5 class="modal-title">Pesquisa obrigatória</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div>
      <div class="modal-body"><p>Para avançar, informe o CNPJ do ente e clique em “Pesquisar”.</p></div>
      <div class="modal-footer"><button class="btn btn-primary" data-bs-dismiss="modal">Ok</button></div>
    </div></div></div>
    <!-- MODAIS DAS FASES (4.1 a 4.6) — conteúdo simples; o JS coleta pelos IDs/checkboxes -->
    <div class="modal fade" id="modalF41" tabindex="-1"><div class="modal-dialog"><div class="modal-content">
      <div class="modal-header"><h5 class="modal-title">Fase 4.1 – Parcelamento</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div>
      <div class="modal-body">
        <div class="form-check"><input class="form-check-input" type="radio" name="F41_OPCAO" value="4.1.1" id="m411"><label class="form-check-label" for="m411">4.1.1 – até 60 parcelas</label></div>
        <div class="form-check"><input class="form-check-input" type="radio" name="F41_OPCAO" value="4.1.2" id="m412"><label class="form-check-label" for="m412">4.1.2 – até 300 parcelas</label></div>
      </div>
    </div></div></div>

    <div class="modal fade" id="modalF42" tabindex="-1"><div class="modal-dialog modal-lg"><div class="modal-content">
      <div class="modal-header"><h5 class="modal-title">Fase 4.2 – Regularização administrativa</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div>
      <div class="modal-body"><div id="F42_LISTA" class="d-flex flex-column gap-2"></div></div>
    </div></div></div>

    <div class="modal fade" id="modalF43" tabindex="-1"><div class="modal-dialog modal-lg"><div class="modal-content">
      <div class="modal-header"><h5 class="modal-title">Fase 4.3 – Déficit atuarial</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div>
      <div class="modal-body">
        <div id="F43_LISTA" class="d-flex flex-column gap-2 mb-2"></div>
        <label class="form-label">Planos/Medidas</label>
        <input id="F43_PLANO" class="form-control mb-2" placeholder="Plano A">
        <input id="F43_PLANO_B" class="form-control mb-2" placeholder="Plano B (opcional)">
        <textarea id="F43_DESC_PLANOS" class="form-control mb-2" rows="2" placeholder="Descrição resumida"></textarea>
        <div class="form-check form-switch mb-2">
          <input class="form-check-input" type="checkbox" id="F43_SOLICITA_INCLUSAO">
          <label class="form-check-label" for="F43_SOLICITA_INCLUSAO">Solicitar inclusão</label>
        </div>
        <div id="F43_INCLUSAO_WRAP" class="d-none"><div id="F43_INCLUIR" class="d-flex flex-column gap-1"></div></div>
        <div class="mt-3">
          <label class="form-label d-block">4.3.10 – A/B</label>
          <label class="form-check me-3"><input class="form-check-input" type="radio" name="F4310_OPCAO" value="A"> <span>Apresentar legislação</span></label>
          <label class="form-check"><input class="form-check-input" type="radio" name="F4310_OPCAO" value="B"> <span>Apresentar documentos</span></label>
          <div id="F4310_LEGISLACAO_WRAP" class="mt-2 d-none"><textarea id="F4310_LEGISLACAO" class="form-control" rows="2" placeholder="Cite a legislação"></textarea></div>
          <div id="F4310_DOCS_WRAP" class="mt-2 d-none"><textarea id="F4310_DOCS" class="form-control" rows="2" placeholder="Liste os documentos"></textarea></div>
        </div>
      </div>
    </div></div></div>

    <div class="modal fade" id="modalF44" tabindex="-1"><div class="modal-dialog modal-lg"><div class="modal-content">
      <div class="modal-header"><h5 class="modal-title">Fase 4.4 – Critérios estruturantes</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div>
      <div class="modal-body">
        <div id="F44_FINALIDADES" class="d-flex flex-column gap-2 mb-2"></div>
        <div class="d-flex align-items-center gap-2 mb-2">
          <label class="form-check mb-0"><input class="form-check-input" type="checkbox" id="F441_OPTD" value="d"> <span>4.4.1(d) – Citar legislação</span></label>
          <div id="F441_LEGISLACAO_WRAP" class="flex-fill d-none"><input id="F441_LEGISLACAO" class="form-control" placeholder="Ex.: Lei nº ..." /></div>
        </div>
        <div class="d-flex align-items-start gap-2 mb-2">
          <label class="form-check mt-1"><input class="form-check-input" type="checkbox" id="F442_OPTE" value="e"> <span>4.4.2(e) – Abrir critérios</span></label>
          <div id="F44_CRIT_WRAP" class="flex-fill d-none"><div id="F44_CRITERIOS" class="d-flex flex-column gap-2"></div></div>
        </div>
        <label class="form-label" for="F44_ANEXOS">Anexos (descrição)</label>
        <textarea id="F44_ANEXOS" class="form-control" rows="2"></textarea>
      </div>
    </div></div></div>

    <div class="modal fade" id="modalF45" tabindex="-1"><div class="modal-dialog"><div class="modal-content">
      <div class="modal-header"><h5 class="modal-title">Fase 4.5 – Compromissos/documentos</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div>
      <div class="modal-body">
        <div class="form-check mb-2"><input class="form-check-input" type="checkbox" id="mF45_451"><label class="form-check-label ms-2" for="mF45_451">4.5.1 – Concordo com os compromissos firmados</label></div>
        <label class="form-label" for="F45_DOCS">Documentos</label><textarea id="F45_DOCS" class="form-control mb-2" rows="2"></textarea>
        <label class="form-label" for="F45_JUST">Justificativas</label><textarea id="F45_JUST" class="form-control mb-2" rows="2"></textarea>
        <label class="form-label" for="F453_EXEC_RES">Execução/resultado esperado</label><textarea id="F453_EXEC_RES" class="form-control" rows="2"></textarea>
      </div>
    </div></div></div>

    <div class="modal fade" id="modalF46" tabindex="-1"><div class="modal-dialog modal-lg"><div class="modal-content">
      <div class="modal-header"><h5 class="modal-title">Fase 4.6 – Manutenção de conformidade</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div>
      <div class="modal-body">
        <div id="F46_CRITERIOS" class="d-flex flex-column gap-2 mb-2"></div>
        <div class="row g-2 mb-2">
          <div class="col-md-4"><label class="form-label" for="F46_PROGESTAO">Nível Pró-Gestão</label>
            <select id="F46_PROGESTAO" class="form-select"><option value="">Selecione…</option><option>Bronze</option><option>Prata</option><option>Ouro</option><option>Diamante</option></select>
          </div>
          <div class="col-md-4"><label class="form-label" for="F46_PORTE">Porte (ISP-RPPS)</label>
            <select id="F46_PORTE" class="form-select"><option value="">Selecione…</option><option>Pequeno</option><option>Médio</option><option>Grande</option></select>
          </div>
        </div>
        <div class="mb-2"><label class="form-label" for="F46_FINALIDADES">Finalidades</label><div id="F46_FINALIDADES" class="d-flex flex-column gap-2"></div></div>
        <div class="mb-2"><label class="form-label" for="F46_ANEXOS">Anexos (descrição)</label><textarea id="F46_ANEXOS" class="form-control" rows="2"></textarea></div>
        <div class="border rounded p-2 mt-2">
          <div class="form-check mb-2"><input class="form-check-input" type="checkbox" id="F462F_OPTF" value="f"><label class="form-check-label" for="F462F_OPTF">4.6.2 (f) – Abrir critérios adicionais</label></div>
          <div id="F462F_WRAP" class="d-none"><div id="F462F_CRITERIOS" class="d-flex flex-column gap-2"></div></div>
        </div>
        <div class="row g-2 mt-2">
          <div class="col-md-6"><label class="form-label" for="F46_JUST_PLANOS">Condição de vigência (se planos)</label><textarea id="F46_JUST_PLANOS" class="form-control" rows="2"></textarea></div>
          <div class="col-md-6"><label class="form-label" for="F46_COMP_CUMPR">Compromissos de cumprimento</label><textarea id="F46_COMP_CUMPR" class="form-control" rows="2"></textarea></div>
        </div>
      </div>
    </div></div></div>

    <!-- SCRIPTS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bodymovin/5.12.2/lottie.min.js"></script>
    <script src="solic_crp.js"></script>
  </div>
</body>
</html>
